(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-585a4954"],{"37da":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container tiger-index-wrapper"},[a("el-form",{attrs:{model:e.formData,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"项目"}},[a("el-select",{staticStyle:{width:"300px"},attrs:{filterable:"",clearable:""},on:{change:e.handleSearch},model:{value:e.formData.project,callback:function(t){e.$set(e.formData,"project",t)},expression:"formData.project"}},e._l(e.sourceData,(function(e,t){return a("el-option",{key:t,attrs:{label:e.artifaceName,value:e.artifaceName}})})),1)],1),a("el-form-item",{attrs:{label:"方案号"}},[a("div",{staticClass:"query-item"},[a("el-select",{staticClass:"btn",attrs:{clearable:""},on:{change:e.handleChangeName},model:{value:e.formData.schemeNo,callback:function(t){e.$set(e.formData,"schemeNo",t)},expression:"formData.schemeNo"}},e._l(e.schemeList,(function(e,t){return a("el-option",{key:t,attrs:{label:t+"("+e+")",value:t}})})),1),a("el-button",{staticClass:"btn",attrs:{type:"warning"},on:{click:e.handleTemplate}},[e._v("下载模板导入模板")]),a("upload-excel-vue",{attrs:{btnText:"导入方案号配置"},on:{success:e.handleImpScheme}})],1)]),a("el-form-item",{attrs:{label:"日期"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd"},on:{change:e.handleChangeName},model:{value:e.formData.date,callback:function(t){e.$set(e.formData,"date",t)},expression:"formData.date"}})],1),a("el-form-item",[a("upload-excel-vue",{attrs:{btnText:"导入项目列表"},on:{success:e.handleSuccess}})],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.tableData,border:"",height:"calc(100vh - 180px)"}},[a("el-table-column",{attrs:{label:"No",type:"index",width:"55",align:"center"}}),a("el-table-column",{attrs:{label:"子类别名称",prop:"sectionName",width:"140"}}),a("el-table-column",{attrs:{label:"目录名称",prop:"artifaceName",width:"140"}}),a("el-table-column",{attrs:{label:"文件名",prop:"docmentName",width:"160"}}),a("el-table-column",{attrs:{label:"自定义名称",prop:"customName"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;t.$index;return[a("div",{staticClass:"custom-name custom-desc"},[e._v(e._s(n.customName))]),a("el-input",{staticClass:"custom-name",attrs:{type:"textarea"},model:{value:n.customName,callback:function(t){e.$set(n,"customName",t)},expression:"row.customName"}})]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;t.$index;return[a("div",{staticStyle:{display:"flex"}},[a("el-button",{staticClass:"btn",attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleCopy(n.customName,t)}}},[e._v("复制")]),a("el-upload",{staticClass:"upload-demo",attrs:{multiple:"",accept:".pdf,.xlsx,.xls,.docx,.doc,.jpeg,.jpg,.png,","show-file-list":!1,action:"","http-request":function(t){return e.handleUpload(t,n)}}},[a("el-button",{attrs:{size:"small",type:"warning"}},[e._v("上传文件")])],1)],1)]}}])})],1),a("el-dialog",{attrs:{visible:e.visible,title:"自定义添加",width:"500px"},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{attrs:{model:e.editForm}},[a("el-form-item",{attrs:{label:"子类别名称",porp:""}},[a("el-select",{attrs:{clearable:""},model:{value:e.editForm.sectionName,callback:function(t){e.$set(e.editForm,"sectionName",t)},expression:"editForm.sectionName"}},e._l(e.sourceData,(function(e,t){return a("el-option",{key:t,attrs:{label:e.sectionName,value:e.sectionName}})})),1)],1),a("el-form-item",{attrs:{label:"目录名称",porp:""}},[a("el-select",{attrs:{clearable:""},model:{value:e.editForm.artifaceName,callback:function(t){e.$set(e.editForm,"artifaceName",t)},expression:"editForm.artifaceName"}},e._l(e.sourceData,(function(e,t){return a("el-option",{key:t,attrs:{label:e.artifaceName,value:e.artifaceName}})})),1)],1),a("el-form-item",{attrs:{label:"文件夹名称",porp:""}},[a("el-select",{attrs:{clearable:""},model:{value:e.editForm.docmentName,callback:function(t){e.$set(e.editForm,"docmentName",t)},expression:"editForm.docmentName"}},e._l(e.sourceData,(function(e,t){return a("el-option",{key:t,staticStyle:{width:"200px"},attrs:{label:e.docmentName,value:e.docmentName}})})),1)],1),a("el-form-item",{attrs:{label:"自定义名称",porp:""}},[a("el-input",{model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1)],1),a("template",{slot:"footer"},[a("el-button",{attrs:{type:"default"}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirm}},[e._v("添加")])],1)],2)],1)},r=[],l=a("5530"),o=a("1da1"),i=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("d81d"),a("b0c0"),a("99af"),a("e9c4"),a("4de4"),a("ac1f"),a("1276"),a("96cf"),a("3796")),s=a("ed08"),c=a("f71e"),m=a("b893"),u=a("c631"),d={components:{UploadExcelVue:i["a"]},data:function(){return{loading:!1,isEdit:-1,editContent:"",visible:!1,editForm:{},tableData:[],sourceData:[],projectList:[],formData:{schemeNo:"",site:"",date:null},siteList:{},schemeList:{},prjStore:null,schStore:null,dataFlag:!1,storeName:"project",schStoreName:"scheme",keyPath:1,dbName:"common",schFlag:!1}},created:function(){this.handleInit()},methods:{handleInit:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["c"])(e.dbName,1.1,e.storeName,"id",["artifaceName"]);case 2:a=t.sent,e.prjStore=a.data,setTimeout(Object(o["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["b"])(e.prjStore,e.storeName,e.keyPath);case 2:a=t.sent,a.data&&(e.dataFlag=!0,e.sourceData=a.data.list,e.tableData=a.data.list,e.handleChangeName());case 4:case"end":return t.stop()}}),t)}))),300),n=localStorage.getItem("scheme"),n&&(e.schemeList=JSON.parse(n));case 7:case"end":return t.stop()}}),t)})))()},handleUpload:function(e,t){var a=URL.createObjectURL(e.file);m["a"].download(a,t.customName)},handleChangeName:function(){var e=this;this.tableData=this.tableData.map((function(t){return Object(l["a"])(Object(l["a"])({},t),{},{customName:e.handleFormatName(t.rename)})}))},handleTemplate:function(){window.open("./方案号配置模板.xlsx")},handleEdit:function(e,t){this.editContent=this.handleFormatName(e.rename),this.isEdit=t},handleSaveEdit:function(e,t){this.isEdit=-1},handleConfirm:function(){this.editForm.rename=this.handleFormatName(this.editForm.name),this.tableData=[this.editForm].concat(this.tableData),this.visible=!1},handleAdd:function(){this.visible=!0},handleCopy:function(e,t){Object(c["a"])(e,t)},handleFormatName:function(e){var t=this.formData.schemeNo||"",a=this.schemeList[t]||"";return t+"_"+a+"_"+e+"_"+this.handleDate(this.formData.date)},handleSearch:function(e){e?(this.tableData=this.sourceData.filter((function(t){return t["artifaceName"]===e})),this.handleChangeName()):(this.tableData=JSON.parse(JSON.stringify(this.sourceData)),this.handleChangeName())},handleSuccess:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.sourceData=e.results.map((function(e){var t=e["Artifact name\r\n目录名称"].split("\r\n");return e["sectionName"]=e["Section Name\r\n子类别名称"],e["docmentName"]=e["Document Name\r\n文件名"],e["artifaceName"]=e["Artifact name\r\n目录名称"],e["rename"]=t[t.length-1],e["customName"]=t[t.length-1],e})),t.tableData=JSON.parse(JSON.stringify(t.sourceData)),!t.dataFlag){a.next=7;break}return a.next=5,Object(u["d"])(t.prjStore,t.storeName,{id:t.keyPath,list:t.tableData});case 5:a.next=9;break;case 7:return a.next=9,Object(u["a"])(t.prjStore,t.storeName,{list:t.tableData});case 9:t.handleChangeName();case 10:case"end":return a.stop()}}),a)})))()},handleImpScheme:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:n={},e.results.map((function(e){return n[e.schemeNo]=e.site,e})),t.schemeList=n,localStorage.setItem("scheme",JSON.stringify(n));case 4:case"end":return a.stop()}}),a)})))()},handleDate:function(e){return Object(s["f"])(e,"yyyyMMdd")}}},h=d,f=(a("d66d"),a("2877")),p=Object(f["a"])(h,n,r,!1,null,null,null);t["default"]=p.exports},"68f2":function(e,t,a){},d66d:function(e,t,a){"use strict";a("68f2")}}]);